<aside id="sidebar" class="bg-white border-r flex-shrink-0
  transition-all duration-200 ease-in-out
  sidebar-open:w-64 sidebar-closed:w-16">

  <!-- Use utility wrapper to handle collapsed/expanded widths.
       Tailwind cannot interpret 'sidebar-open:w-64' by default,
       but we use JS to add/remove classes on root element. -->

  <div class="h-full flex flex-col">
    <div class="px-3 py-4 flex items-center justify-between">
      <div class="flex items-center gap-2">
        <%= link_to root_path, class: "flex items-center gap-2" do %>
          <div class="h-8 w-8 rounded flex items-center justify-center text-white font-bold" style="background:brand">D</div>
          <span class="hidden sidebar-closed:hidden md:inline-block font-semibold text-gray-900">devwerkhouz</span>
        <% end %>
      </div>

      <button aria-label="Toggle sidebar" onclick="toggleSidebar()" class="p-1 rounded hover:bg-gray-100">
        <!-- simple hamburger icon -->
        <svg class="h-5 w-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
      </button>
    </div>

    <nav class="px-2 py-2 flex-1 overflow-y-auto">
      <ul class="space-y-1">
        <li>
          <%= link_to new_prompt_path, class: "flex items-center gap-3 p-2 rounded hover:bg-gray-50" do %>
            <svg class="h-5 w-5 text-brand" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-width="2" d="M12 4v16M4 12h16"/></svg>
            <span class="hidden md:inline">New prompt</span>
          <% end %>
        </li>

        <li class="mt-3">
          <h4 class="text-xs text-gray-500 px-2 hidden md:block">History</h4>
          <% if user_signed_in? %>
            <% current_user.prompts.order(created_at: :desc).limit(20).each do |p| %>
              <div class="px-1">
                <%= link_to prompt_path(p), data: { turbo_frame: "prompt_show" }, class: "flex items-center gap-2 p-2 rounded hover:bg-gray-50 text-sm" do %>
                  <span class="truncate"><%= p.idea.truncate(40) %></span>
                  <span class="ml-auto text-xs text-gray-400 hidden md:inline"><%= p.created_at.strftime("%b %-d") %></span>
                <% end %>
              </div>
            <% end %>
          <% else %>
            <p class="text-sm text-gray-500 px-2">Sign in to save prompts</p>
          <% end %>
        </li>
      </ul>
    </nav>
  </div>
</aside>
